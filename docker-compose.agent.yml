services:
  alloy:
    image: grafana/alloy:v1.0.0
    container_name: alloy-agent
    ports:
      - "12345:12345" # Ekspos port agar bisa di-scrape
    volumes:
      - ./alloy/config.alloy:/etc/alloy/config.alloy
      - /var/log:/var/log:ro
      - /var/run/docker.sock:/var/run/docker.sock:ro
      # Tambahkan volume berikut untuk metrik sistem yang lebih lengkap
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro
    command: run /etc/alloy/config.alloy --server.http.listen-addr=0.0.0.0:12345
    restart: unless-stopped
  